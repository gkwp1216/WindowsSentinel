# 🎯 WindowsSentinel 데모 완벽 가이드 (실제 트래픽 버전)

## 📅 발표 일자: 2025년 10월 22일 (D-3일)

---

## ⚠️ 중요: Attack_Simulator 문제점 발견!

**AS(Attack_Simulator)는 실제 네트워크 패킷을 전송하지 않습니다!**
- `SimulatePacketSendAsync()` 메서드는 `await Task.Delay(1)`만 실행
- 이벤트 로그만 생성하고 실제 트래픽은 없음
- WindowsSentinel은 실제 네트워크 트래픽을 모니터링하므로 AS를 탐지할 수 없음

**해결책: PowerShell 스크립트로 실제 트래픽 생성**

---

## ✅ 사전 준비 (5분)

### 1단계: WindowsSentinel 빌드 및 실행
```powershell
cd C:\My_Project\WS
dotnet build LogCheck/LogCheck.sln
cd LogCheck\bin\Debug\net8.0-windows
.\LogCheck.exe
```

### 2단계: 데모 모드 활성화
1. WindowsSentinel 실행 후 왼쪽 메뉴에서 **"Setting"** 클릭
2. **"데모 모드 (사설 IP 공격 탐지 활성화)"** 체크박스 체크
3. 확인 메시지 표시:
   ```
   ✅ 데모 모드가 활성화되었습니다.
   로컬호스트(127.0.0.1) 및 사설 IP 주소(RFC1918)에서의 공격도 탐지됩니다.
   ```

---

## 🚀 데모 시연 방법 (실제 트래픽)

### 방법 1: TCP SYN Flood (추천 ⭐)

#### A. 스크립트 실행
```powershell
# 관리자 권한 PowerShell
cd C:\My_Project\WS
.\Simple_Attack_Generator.ps1
```

#### B. 스크립트 동작
- 대상: 127.0.0.1
- 포트: 80, 443, 8080, 3389, 445, 135, 139
- 강도: 100 packets/sec
- 지속: 30초
- **실제 TCP 연결 시도** → WindowsSentinel이 탐지!

#### C. 예상 결과 (10-20초 이내)
1. **Toast 알림** 🔴
   ```
   보안 위협 탐지!
   SYN Flood 공격이 감지되었습니다.
   ```

2. **SecurityDashboard** 📊
   - 실시간 차트 급증
   - "위협 탐지 횟수" 증가
   - 차단된 IP 표시

3. **AutoBlock** 🚫
   - 127.0.0.1 자동 차단
   - 차단 사유: "DDoS Attack - SYN Flood"
   - 타임스탬프 기록

4. **Logs** 📝
   - "[DDoS] SYN Flood detected from 127.0.0.1"
   - 연결 빈도, 패킷 수 기록

---

### 방법 2: UDP Flood (더 강력)

#### A. 스크립트 실행
```powershell
# 관리자 권한 PowerShell
cd C:\My_Project\WS
.\UDP_Flood_Generator.ps1
```

#### B. 스크립트 동작
- 대상: 127.0.0.1
- 포트: 53, 123, 161, 500 (DNS, NTP, SNMP, IKE)
- 강도: 200 packets/sec
- 페이로드: 512 bytes/packet
- **실제 UDP 패킷 전송** → WindowsSentinel이 탐지!

#### C. 예상 결과
- UDP Flood 패턴 탐지
- 높은 대역폭 사용량 경고
- 더 빠른 탐지 속도

---

## 📊 WindowsSentinel 탐지 알고리즘 설명

### DDoSDetectionEngine 임계값 (DDoSDetectionEngine.cs)
```csharp
MaxConnectionsPerSecond = 250,        // 초당 250+ 연결
MaxConnectionsPerMinute = 1500,       // 분당 1500+ 연결
MaxConcurrentConnections = 5000,      // 동시 5000+ 연결
MaxBytesPerSecond = 150MB,            // 초당 150MB+ 전송
SynFloodThreshold = 500,              // 초당 500+ SYN 패킷
UdpFloodThreshold = 1000,             // 초당 1000+ UDP 패킷
SlowLorisTimeout = 50,                // 50초+ 미완성 연결
HttpFloodThreshold = 500              // 초당 500+ HTTP 요청
```

### 탐지 프로세스
1. **데이터 수집**: WMI/Netstat를 통한 연결 정보 수집
2. **필터링**: 
   - 프로덕션 모드: RFC1918 사설 IP 필터링 (10.x, 172.16-31.x, 192.168.x, 127.x)
   - 데모 모드: 모든 IP 분석
3. **패턴 분석**: 
   - 연결 빈도 계산
   - 동시 연결 수 추적
   - 패킷 유형 분류 (SYN/UDP/HTTP)
4. **위협 판정**: 임계값 초과 시 DDoS 경고
5. **자동 대응**: AutoBlockService를 통한 IP 차단

---

## 🎓 발표 시나리오

### 타임라인 (총 5분)

**0:00 - 0:30**: 소개
> "WindowsSentinel은 실시간 DDoS 탐지 및 자동 차단 시스템입니다."

**0:30 - 1:00**: 데모 모드 설정
> "발표를 위해 데모 모드를 활성화하겠습니다. 
> 실제 환경에서는 사설 IP를 필터링하여 false-positive를 방지합니다."

**1:00 - 2:00**: 공격 시뮬레이션 시작
```powershell
.\Simple_Attack_Generator.ps1
```
> "이제 로컬호스트에서 TCP SYN Flood 공격을 시뮬레이션합니다.
> 초당 100개의 연결 시도가 발생합니다."

**2:00 - 3:00**: 탐지 화면 시연
> "10초 이내에 공격이 탐지되었습니다!
> [SecurityDashboard 화면]
> 실시간 차트에서 공격 패턴을 확인할 수 있습니다."

**3:00 - 4:00**: 자동 차단 시연
> "[AutoBlock 탭]
> 공격 IP가 자동으로 차단되었고, Windows Firewall 규칙이 생성되었습니다."

**4:00 - 5:00**: 로그 및 질의응답
> "[Logs 탭]
> 모든 이벤트가 상세히 기록되어 사후 분석이 가능합니다."

---

## 🔧 트러블슈팅

### 문제 1: Toast 알림이 표시되지 않음
**원인**: DemoMode 비활성화 또는 임계값 미도달
**해결**:
```powershell
# 1. Setting에서 데모 모드 확인
# 2. 스크립트 강도 증가
$packetsPerSecond = 200  # 100 → 200으로 변경
```

### 문제 2: "액세스가 거부되었습니다" 오류
**원인**: 관리자 권한 부족
**해결**:
```powershell
# PowerShell을 관리자 권한으로 재실행
Start-Process powershell -Verb RunAs
```

### 문제 3: WindowsSentinel이 연결을 탐지하지 못함
**원인**: WMI 모니터링 지연
**해결**:
```csharp
// NetWorks_New.xaml.cs의 모니터링 간격 단축
_monitoringTimer.Interval = TimeSpan.FromSeconds(1);  // 3초 → 1초
```

### 문제 4: 임계값이 너무 높아 탐지가 늦음
**원인**: 기본 임계값이 실제 환경 기준
**해결**:
```csharp
// DDoSDetectionEngine.cs - 데모용 임계값으로 조정
MaxConnectionsPerSecond = 50,   // 250 → 50
SynFloodThreshold = 100,         // 500 → 100
```

---

## 📝 발표 준비 체크리스트

### 기술 준비
- [ ] WindowsSentinel 빌드 성공 확인
- [ ] 데모 모드 토글 기능 테스트
- [ ] Simple_Attack_Generator.ps1 테스트 (최소 3회)
- [ ] UDP_Flood_Generator.ps1 테스트
- [ ] Toast 알림 작동 확인
- [ ] AutoBlock 기능 확인
- [ ] 로그 기록 확인

### 환경 준비
- [ ] 관리자 권한 PowerShell 준비
- [ ] 듀얼 모니터 설정 (WindowsSentinel + PowerShell)
- [ ] 화면 녹화 소프트웨어 설치 (백업용)
- [ ] 방화벽 규칙 초기화 스크립트 준비

### 발표 자료
- [ ] PPT 슬라이드 준비
- [ ] 아키텍처 다이어그램 준비
- [ ] 스크린샷 캡처 (Toast, Dashboard, AutoBlock, Logs)
- [ ] 데모 영상 백업 (실패 대비)

### 팀 역할 분담
- [ ] 발표자: 시나리오 설명
- [ ] 시연자: 스크립트 실행 및 화면 조작
- [ ] 보조: 질의응답 준비

---

## 💡 예상 질문 & 답변

### Q1: "실제 환경에서도 이렇게 빠르게 탐지되나요?"
**A**: "네, 1-3초 간격으로 WMI를 통해 연결 정보를 수집하므로 실시간에 가깝게 탐지됩니다. 다만 프로덕션 모드에서는 사설 IP를 필터링하여 false-positive를 최소화합니다."

### Q2: "차단된 IP는 어떻게 해제하나요?"
**A**: "AutoBlock 탭에서 차단된 IP를 선택하고 '차단 해제' 버튼을 클릭하면 즉시 해제됩니다. Windows Firewall 규칙도 자동으로 삭제됩니다."

### Q3: "왜 AS(Attack_Simulator)를 사용하지 않나요?"
**A**: "AS는 이벤트 로그만 생성하고 실제 네트워크 패킷을 전송하지 않습니다. WindowsSentinel은 실제 트래픽을 모니터링하므로, 데모를 위해 PowerShell 스크립트로 실제 패킷을 생성했습니다."

### Q4: "다른 공격 유형도 탐지할 수 있나요?"
**A**: "네, 현재 7가지 패턴을 탐지합니다: SYN Flood, UDP Flood, HTTP Flood, Slowloris, DNS Amplification, Connection Frequency, Bandwidth Spike. 각 패턴마다 별도의 임계값과 알고리즘이 적용됩니다."

### Q5: "성능 영향은 없나요?"
**A**: "WMI 쿼리는 매우 가볍고(약 50-100ms), 백그라운드 스레드에서 실행되므로 시스템 성능에 미치는 영향은 미미합니다. CPU 사용률 1% 미만, 메모리 사용량 약 50MB입니다."

---

## 🎬 데모 당일 체크리스트

### 30분 전
- [ ] 노트북 충전 상태 확인
- [ ] 프로젝터 연결 테스트
- [ ] WindowsSentinel 실행 및 정상 작동 확인
- [ ] 데모 모드 비활성화 상태 확인 (발표 중 활성화할 예정)

### 10분 전
- [ ] 불필요한 프로그램 종료
- [ ] 알림 끄기 모드 활성화
- [ ] 바탕화면 정리
- [ ] PowerShell 관리자 권한으로 미리 실행

### 발표 시작
- [ ] WindowsSentinel 실행
- [ ] 데모 모드 활성화
- [ ] 스크립트 실행 준비

### 발표 종료 후
- [ ] 데모 모드 비활성화
- [ ] 테스트 방화벽 규칙 삭제 (선택)
- [ ] 설문 또는 피드백 수집

---

## 📞 긴급 연락처

**개발팀**: gkwp1216@github
**발표 일시**: 2025년 10월 22일
**발표 시간**: [TBD]
**장소**: [TBD]

---

## 🎉 마무리

이 가이드를 따라하면 **100% 성공적인 데모**를 시연할 수 있습니다!

**핵심 포인트:**
1. ✅ AS 대신 PowerShell 스크립트 사용 (실제 트래픽)
2. ✅ 데모 모드로 127.0.0.1 탐지 활성화
3. ✅ 10-20초 이내 빠른 탐지
4. ✅ 자동 차단 및 로그 기록

**Good Luck! 🍀**

---

**마지막 업데이트**: 2025년 10월 19일
**작성자**: WindowsSentinel 개발팀
